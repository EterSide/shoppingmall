<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default}" lang="en">
<head>
  <style>
    .center-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh; /* 화면 높이를 꽉 채우도록 설정 */
    }

    .form-container {
      width: 100%;
      max-width: 400px; /* 폼의 최대 너비를 설정 */
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 약간의 그림자 효과 */
      border-radius: 10px; /* 테두리 둥글게 */
      background-color: #ffffff; /* 배경색 */
    }

    .preview-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-container img {
      max-width: 100px;
      max-height: 100px;
      object-fit: cover;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
  </style>
</head>
<body>
<div layout:fragment="content">
  <div class="center-container">
    <div class="form-container">
      <h2 class="text-center">쿠폰 등록</h2>
      <th:block th:each="coupon : ${coupons}" th:if="${coupon.status.toString().equals('ACTIVE')}">
        <div class="mb-3 coupon-item" th:data-coupon-id="${coupon.id}">
          <div class="card border-success mb-3" style="max-width: 18rem;">
            <div class="card-header bg-transparent border-success">Header</div>
            <div class="card-body text-success">
              <h5 class="card-title" th:text="${coupon.name}"></h5>
              <p class="card-text" th:text="${coupon.description}"></p>
            </div>
            <div class="card-footer bg-transparent border-success" th:text="${coupon.endDate} + '일까지 사용가능'"></div>
          </div>
        </div>
      </th:block>
    </div>
  </div>
</div>

<script>
  function checkCoupon(element) {
    const couponId = element.getAttribute('data-coupon-id');

    // AJAX 요청 보내기
    fetch(`/issued_coupon/register/${couponId}`)
            .then(response => response.json())
            .then(data => {
              if (data.exists) {
                alert('쿠폰이 존재합니다!');
              } else {
                alert('쿠폰이 존재하지 않습니다.');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              alert('쿠폰 조회 중 오류가 발생했습니다.');
            });
  }

  // 모든 쿠폰 항목에 이벤트 리스너 추가
  document.querySelectorAll('.coupon-item').forEach(item => {
    item.addEventListener('click', function() {
      checkCoupon(this);
    });
  });
</script>

</body>
</html>



